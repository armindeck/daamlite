# daamlite - MIT License - (c) 2025 Armin Deck - https://github.com/armindeck/daamlite

# ================================
# Configuración de errores y entorno
# ================================
php_flag display_errors On
php_flag display_startup_errors On
php_value error_reporting -1

# Charset por defecto
AddDefaultCharset UTF-8

# Zona horaria
php_value date.timezone "America/Bogota"

# ================================
# Seguridad
# ================================

# Bloquear listado de directorios (403 Forbidden si no hay index.php/html)
Options -Indexes

# Bloquear acceso a archivos ocultos (.htaccess, .gitignore, .env, etc.)
<FilesMatch "^\.">
    Require all denied
</FilesMatch>

# Bloquear acceso a archivos sensibles típicos
<FilesMatch "(composer\.json|composer\.lock|package\.json|database\.json|yarn\.lock|phpunit\.xml|\.env)">
    Require all denied
</FilesMatch>

# ================================
# Sistema de rutas
# ================================
RewriteEngine On

# Permitir acceso directo a /assets y /process
RewriteCond %{REQUEST_URI} ^/(assets|process)/ [NC]
RewriteRule ^ - [L]

# Redirigir todo lo demás a index.php (router)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php?route=$1 [L,QSA]

# ================================
# Errores personalizados
# ================================
ErrorDocument 400 /daamlite/index.php?route=error/400
ErrorDocument 401 /daamlite/index.php?route=error/401
ErrorDocument 403 /daamlite/index.php?route=error/403
ErrorDocument 404 /daamlite/index.php?route=error/404
ErrorDocument 500 /daamlite/index.php?route=error/500
ErrorDocument 503 /daamlite/index.php?route=error/503